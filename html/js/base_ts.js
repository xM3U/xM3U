var SERVER=new Object,BULK_EDIT=!1,COLUMN_TO_SORT,SEARCH_MAPPING=new Object,UNDO=new Object,SERVER_CONNECTION=!1,WS_AVAILABLE=!1,menuItems=new Array;menuItems.push(new MainMenuItem("playlist","{{.mainMenu.item.playlist}}","m3u.png","{{.mainMenu.headline.playlist}}")),menuItems.push(new MainMenuItem("filter","{{.mainMenu.item.filter}}","filter.png","{{.mainMenu.headline.filter}}")),menuItems.push(new MainMenuItem("xmltv","{{.mainMenu.item.xmltv}}","xmltv.png","{{.mainMenu.headline.xmltv}}")),menuItems.push(new MainMenuItem("mapping","{{.mainMenu.item.mapping}}","mapping.png","{{.mainMenu.headline.mapping}}")),menuItems.push(new MainMenuItem("users","{{.mainMenu.item.users}}","users.png","{{.mainMenu.headline.users}}")),menuItems.push(new MainMenuItem("settings","{{.mainMenu.item.settings}}","settings.png","{{.mainMenu.headline.settings}}")),menuItems.push(new MainMenuItem("log","{{.mainMenu.item.log}}","log.png","{{.mainMenu.headline.log}}")),menuItems.push(new MainMenuItem("logout","{{.mainMenu.item.logout}}","logout.png","{{.mainMenu.headline.logout}}"));var settingsCategory=new Array;settingsCategory.push(new SettingsCategoryItem("{{.settings.category.general}}","xteveAutoUpdate,tuner,epgSource,api")),settingsCategory.push(new SettingsCategoryItem("{{.settings.category.files}}","update,files.update,temp.path,cache.images,xepg.replace.missing.images")),settingsCategory.push(new SettingsCategoryItem("{{.settings.category.streaming}}","buffer,udpxy,buffer.size.kb,buffer.timeout,user.agent,ffmpeg.path,ffmpeg.options,vlc.path,vlc.options")),settingsCategory.push(new SettingsCategoryItem("{{.settings.category.backup}}","backup.path,backup.keep")),settingsCategory.push(new SettingsCategoryItem("{{.settings.category.authentication}}","authentication.web,authentication.pms,authentication.m3u,authentication.xml,authentication.api"));function showPopUpElement(e){for(var a=new Array("popup-custom"),t=0;t<a.length;t++)showElement(a[t],!1);showElement(e,!0),setTimeout(function(){showElement("popup",!0)},10)}function showElement(e,a){var t;switch(a){case!0:t="block";break;case!1:t="none";break}document.getElementById(e).className=t}function changeButtonAction(e,a,t){var n=e.options[e.selectedIndex].value;document.getElementById(a).setAttribute(t,n)}function getLocalData(e,a){var t=new Object;switch(e){case"m3u":t=SERVER.settings.files[e][a];break;case"hdhr":t=SERVER.settings.files[e][a];break;case"filter":case"custom-filter":case"group-title":a==-1&&(t.active=!0,t.caseSensitive=!1,t.description="",t.exclude="",t.filter="",t.include="",t.name="",t.type="group-title",SERVER.settings.filter[a]=t),t=SERVER.settings.filter[a];break;case"xmltv":t=SERVER.settings.files[e][a];break;case"users":t=SERVER.users[a].data;break;case"mapping":t=SERVER.xepg.epgMapping[a];break;case"m3uGroups":t=SERVER.data.playlist.m3u.groups;break}return t}function getObjKeys(e){var a=new Array;for(var t in e)e.hasOwnProperty(t)&&a.push(t);return a}function getAllSelectedChannels(){var e=new Array;if(BULK_EDIT==!1)return e;for(var a=document.getElementById("content_table").getElementsByTagName("TR"),t=1;t<a.length;t++)a[t].style.display!="none"&&a[t].firstChild.firstChild.checked==!0&&e.push(a[t].id);return e}function selectAllChannels(){var e=!1,a=document.getElementById("content_table").getElementsByTagName("TR");a[0].firstChild.firstChild.checked==!0&&(e=!0);for(var t=1;t<a.length;t++)if(a[t].style.display!="none")switch(e){case!0:a[t].firstChild.firstChild.checked=!0;break;case!1:a[t].firstChild.firstChild.checked=!1;break}}function bulkEdit(){BULK_EDIT=!BULK_EDIT;var e,a=document.getElementsByClassName("bulk");switch(BULK_EDIT){case!0:e="bulk showBulk";break;case!1:e="bulk hideBulk";break}for(var t=0;t<a.length;t++)a[t].className=e,a[t].checked=!1}function sortTable(e){if(e!=COLUMN_TO_SORT){var a=document.getElementById("content_table"),t=a.getElementsByTagName("TR")[0],n=t.getElementsByTagName("TD"),r=new Object,l,s,o,c=!1;e>0&&COLUMN_TO_SORT>0&&(n[COLUMN_TO_SORT].className="pointer",n[e].className="sortThis"),COLUMN_TO_SORT=e;var u=a.rows;if(u[1]!=null){for(o=u[0],l=u[1].getElementsByTagName("TD")[e],i=1;i<u.length;i++){switch(l=u[i].getElementsByTagName("TD")[e],l.childNodes[0].tagName.toLowerCase()){case"input":s=l.getElementsByTagName("INPUT")[0].value.toLowerCase();break;case"p":s=l.getElementsByTagName("P")[0].innerText.toLowerCase();break;default:}if(s==""||Number.isNaN(s))s=i,r[i]=u[i];else switch(isNaN(s)){case!1:s=parseFloat(s),r[s]=u[i];break;case!0:c=!0,r[s.toLowerCase()+i]=u[i];break}}for(;a.firstChild;)a.removeChild(a.firstChild);var m=getObjKeys(r);if(c==!0)m.sort();else{let g=function(p,f){return p-f};var d=g;m.sort(g)}a.appendChild(o);for(var i=0;i<m.length;i++)a.appendChild(r[m[i]])}}}function createSearchObj(){SEARCH_MAPPING=new Object;var e=SERVER.xepg.epgMapping,a=getObjKeys(e),t=["x-active","x-channelID","x-name","_file.m3u.name","x-group-title","x-xmltv-file"];a.forEach(n=>{t.forEach(r=>{if(r=="x-active")switch(e[n][r]){case!0:SEARCH_MAPPING[n]="online ";break;case!1:SEARCH_MAPPING[n]="offline ";break}else if(r=="x-xmltv-file"){var l=getValueFromProviderFile(e[n][r],"xmltv","name");l!=null&&(SEARCH_MAPPING[n]=SEARCH_MAPPING[n]+l+" ")}else SEARCH_MAPPING[n]=SEARCH_MAPPING[n]+e[n][r]+" "})})}function searchInMapping(){for(var e=document.getElementById("searchMapping").value,a=document.getElementById("content_table").getElementsByTagName("TR"),t=1;t<a.length;++t){var n=a[t].getAttribute("id"),r=SEARCH_MAPPING[n];switch(r.toLowerCase().includes(e.toLowerCase())){case!0:document.getElementById(n).style.display="";break;case!1:document.getElementById(n).style.display="none";break}}}function calculateWrapperHeight(){if(document.getElementById("box-wrapper")){for(var e=document.getElementById("box-wrapper"),a=new Array("myStreamsBox","clientInfo","content"),t=0-e.offsetHeight,n=0;n<a.length;n++)t=t+document.getElementById(a[n]).offsetHeight;e.style.height=window.innerHeight-t+"px"}}function changeChannelNumber(e){var a=e.parentNode.parentNode.id,t=parseFloat(e.value),n=[],r=SERVER.xepg.epgMapping,l=getObjKeys(r);if(isNaN(t)){alert("{{.alert.invalidChannelNumber}}");return}l.forEach(o=>{var c=parseFloat(r[o]["x-channelID"]);n.push(c)});for(var s=0;s<n.length&&n.indexOf(t)!=-1;s++)Math.floor(t)==t?t=t+1:(t=t+.1,t.toFixed(1),t=Math.round(t*10)/10);r[a]["x-channelID"]=t.toString(),e.value=t,COLUMN_TO_SORT==1&&(COLUMN_TO_SORT=-1,sortTable(1))}function backup(){var e=new Object,a="xteveBackup",t=new Server(a);t.request(e)}function toggleChannelStatus(e){var a,t;if(document.getElementById("active")){var n=document.getElementById("active");t=n.checked}var r=getAllSelectedChannels();r.length==0&&r.push(e),r.forEach(l=>{var s=SERVER.xepg.epgMapping[l];switch(s["x-active"]=t,s["x-active"]){case!0:(s["x-xmltv-file"]=="-"||s["x-mapping"]=="-")&&(BULK_EDIT==!1&&(alert(s["x-name"]+": Missing XMLTV file / channel"),n.checked=!1),s["x-active"]=!1);break;case!1:break}s["x-active"]==!1?document.getElementById(l).className="notActiveEPG":document.getElementById(l).className="activeEPG"})}function restore(){document.getElementById("upload")&&document.getElementById("upload").remove();var e=document.createElement("INPUT");e.setAttribute("type","file"),e.setAttribute("class","notVisible"),e.setAttribute("name",""),e.id="upload",document.body.appendChild(e),e.click(),e.onchange=function(){var a=e.files[0].name,t=confirm("File: "+a+`
{{.confirm.restore}}`);if(t==!0){var n=new FileReader,r=document.querySelector("input[type=file]").files[0];r?(n.readAsDataURL(r),n.onload=function(){var l=new Object,s="xteveRestore";l.base64=n.result;var o=new Server(s);o.request(l)}):alert("File could not be loaded"),e.remove();return}}}function uploadLogo(){document.getElementById("upload")&&document.getElementById("upload").remove();var e=document.createElement("INPUT");e.setAttribute("type","file"),e.setAttribute("class","notVisible"),e.setAttribute("name",""),e.id="upload",document.body.appendChild(e),e.click(),e.onblur=function(){alert()},e.onchange=function(){var a=e.files[0].name,t=new FileReader,n=document.querySelector("input[type=file]").files[0];n?(t.readAsDataURL(n),t.onload=function(){var r=new Object,l="uploadLogo";r.base64=t.result,r.filename=n.name;var s=new Server(l);s.request(r);var o=document.getElementById("update-icon");o.checked=!1,o.className="changed"}):alert("File could not be loaded"),e.remove()}}function checkUndo(e){switch(e){case"epgMapping":UNDO.hasOwnProperty(e)?SERVER.xepg[e]=JSON.parse(JSON.stringify(UNDO[e])):UNDO[e]=JSON.parse(JSON.stringify(SERVER.xepg[e]));break;default:break}}function sortSelect(e){for(var a=[],t=e[e.selectedIndex].value,n=0;n<e.options.length;n++)a.push(e.options[n]);for(a.sort(function(l,s){return l.text<s.text?-1:1});e.options.length>0;)e.options[0]=null;for(var r=0,n=0;n<a.length;n++)e.options[n]=a[n],e.options[n].value==t&&(r=n);e.selectedIndex=r}function updateLog(){var e=new Server("updateLog");e.request(new Object)}
